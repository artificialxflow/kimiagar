# پروژه کیمیاگر - چک‌لیست به‌روزرسانی و ویژگی‌های جدید

## 🎯 خلاصه پروژه
- **نام:** کیمیاگر (Kimiagar)
- **نوع:** پلتفرم مدیریت طلا و کیف پول دیجیتال
- **وضعیت فعلی:** ✅ **سیستم پایه کار می‌کند، نیاز به بهبودهای اساسی دارد**
- **هدف:** تبدیل به پلتفرم کامل و حرفه‌ای خرید و فروش طلا
- **آخرین بررسی:** 30 تیر 1403 - تست کامل پروژه انجام شد

---

## 🎉 **کارهای انجام شده در جلسه 31 تیر 1403**

### ✅ **مرحله 1: رفع خطای OTP**
- [x] **مشکل فیلد `lastFailedLoginAt`** - اضافه کردن به Prisma Schema
- [x] **Migration جدید** - `add_failed_login_fields` ایجاد و اجرا شد
- [x] **Prisma Client** - به‌روزرسانی شد (نسخه 6.12.0)

### ✅ **مرحله 2: ایجاد API Commissions**
- [x] **فایل `app/api/commissions/route.ts`** - ایجاد شد
- [x] **CRUD کامل** - GET, POST, PATCH, DELETE
- [x] **کارمزدهای پیش‌فرض** - برای تمام محصولات شامل سکه‌های 86
- [x] **اعتبارسنجی** - نرخ‌های 0% تا 10%

### ✅ **مرحله 3: بهبود فونت و Layout**
- [x] **فونت Tahoma** - حذف شد
- [x] **فونت Vazirmatn** - در `app/layout.tsx` اعمال شد
- [x] **یکسان‌سازی فونت** - در تمام پروژه

### ✅ **مرحله 4: اضافه کردن سکه‌های 86**
- [x] **API Prices** - قیمت‌های پیش‌فرض برای سکه‌های 86
- [x] **API Commissions** - کارمزدهای پیش‌فرض برای سکه‌های 86
- [x] **UI Trading** - نمایش نام‌های فارسی سکه‌های 86
- [x] **API Trading** - استفاده از کارمزدهای دینامیک

### ✅ **مرحله 5: بهبود سیستم لاگین و OTP**
- [x] **کامپوننت OTPForm** - ایجاد شد با تایمر و UI زیبا
- [x] **بهبود LoginForm** - اضافه کردن فیلد شماره موبایل
- [x] **سیستم OTP** - ورود با شماره موبایل + کد 6 رقمی
- [x] **صفحه لاگین** - بهبود یافت با قابلیت OTP

---

## 📊 **وضعیت فعلی پروژه (31 تیر 1403)**

### ✅ **ویژگی‌های پیاده‌سازی شده:**
- [x] **ساختار دیتابیس کامل** - Prisma Schema با تمام جداول مورد نیاز
- [x] **سیستم احراز هویت پایه** - JWT + bcrypt بدون NextAuth
- [x] **API Routes اصلی** - auth, trading, wallet, prices
- [x] **کامپوننت‌های React** - Dashboard, Trading, Wallet
- [x] **سیستم قیمت‌گذاری** - خرید و فروش طلا و سکه
- [x] **مدیریت کیف پول** - ریال و طلا
- [x] **سیستم تراکنش‌ها** - خرید، فروش، انتقال
- [x] **مدل‌های دیتابیس** - User, Wallet, Transaction, Order, Price, Transfer, DeliveryRequest
- [x] **سیستم OTP** - ارسال و تایید کد 6 رقمی
- [x] **ثبت‌نام پیشرفته** - با فیلدهای کامل و اعتبارسنجی

### ✅ **مشکلات حل شده:**
- [x] **خطای OTP در send-otp** - مشکل در فیلد `lastFailedLoginAt` حل شد
- [x] **فایل commissions/route.ts** - ایجاد شد و کامل پیاده‌سازی شد
- [x] **فونت Tahoma در layout.tsx** - به Vazirmatn تغییر کرد
- [x] **سکه‌های 86** - در UI نمایش داده می‌شود و API ها به‌روزرسانی شد
- [ ] **سیستم SMS واقعی** - فقط console.log در development
- [ ] **سیستم ایمیل** - فقط console.log در development

### ✅ **نیازهای فوری حل شده (هفته 1):**
1. ✅ **رفع خطای OTP** - مشکل در فیلد `lastFailedLoginAt` حل شد
2. ✅ **ایجاد API commissions** - برای مدیریت کارمزدها ایجاد شد
3. ✅ **بهبود UI** - سیستم OTP و لاگین بهبود یافت
4. ⚠️ **اتصال SMS/Email** - نیاز به اتصال به سرویس‌های واقعی

---

## 🔐 سیستم احراز هویت پیشرفته

### اولویت: **بالا** - امنیت و تجربه کاربری بهتر

#### ✅ **لاگین با SMS (OTP) - پیاده‌سازی شده**
- [x] **ارسال کد OTP:** ارسال کد 6 رقمی به شماره موبایل کاربر
- [x] **تایید کد:** بررسی صحت کد وارد شده
- [x] **مدت اعتبار:** کد OTP معتبر برای 5 دقیقه
- [x] **محدودیت ارسال:** حداکثر 3 بار در ساعت
- [x] **امنیت:** استفاده از rate limiting برای جلوگیری از spam

#### ✅ **ثبت‌نام با ایمیل + تایید کد - پیاده‌سازی شده**
- [x] **فیلدهای جدید:** نام، نام خانوادگی، شماره موبایل، کد ملی، ایمیل
- [x] **ارسال کد تایید:** ارسال کد 6 رقمی به ایمیل کاربر
- [x] **تایید ایمیل:** کاربر باید کد را وارد کند تا حساب فعال شود
- [x] **مدت اعتبار:** کد تایید معتبر برای 15 دقیقه
- [x] **محدودیت ارسال:** حداکثر 5 بار در روز

#### ✅ **فیلدهای جدید ثبت‌نام - پیاده‌سازی شده**
- [x] **نام:** حداقل 2، حداکثر 30 کاراکتر
- [x] **نام خانوادگی:** حداقل 2، حداکثر 30 کاراکتر
- [x] **شماره موبایل:** فرمت 11 رقمی ایران (09xxxxxxxxx)
- [x] **کد ملی:** 10 رقمی، بررسی صحت
- [x] **ایمیل:** فرمت معتبر، منحصر به فرد
- [x] **رمز عبور:** حداقل 8 کاراکتر، شامل حروف و اعداد
- [x] **تایید رمز عبور:** تطبیق با رمز عبور اصلی

#### ✅ **به‌روزرسانی دیتابیس - پیاده‌سازی شده**
- [x] **فیلد email:** اضافه کردن به مدل User
- [x] **فیلد isEmailVerified:** وضعیت تایید ایمیل
- [x] **فیلد emailVerificationCode:** کد تایید ایمیل
- [x] **فیلد emailVerificationExpires:** تاریخ انقضای کد
- [x] **فیلد phoneVerificationCode:** کد تایید موبایل
- [x] **فیلد phoneVerificationExpires:** تاریخ انقضای کد

#### ✅ **API Routes جدید - پیاده‌سازی شده**
- [x] **POST /api/auth/send-otp:** ارسال کد OTP برای لاگین
- [x] **POST /api/auth/verify-otp:** تایید کد OTP
- [x] **POST /api/auth/register:** ثبت‌نام با تمام فیلدها
- [x] **POST /api/auth/login:** ورود با username/password
- [x] **POST /api/auth/logout:** خروج از سیستم
- [x] **POST /api/auth/refresh:** تمدید توکن

#### ⚠️ **سرویس‌های خارجی - نیاز به پیاده‌سازی**
- [ ] **سرویس SMS:** اتصال به سرویس ارسال SMS (کاوه‌پیام، ملی‌پیام)
- [ ] **سرویس ایمیل:** اتصال به سرویس ارسال ایمیل (SendGrid، Mailgun)
- [ ] **تنظیمات محیطی:** API keys و تنظیمات سرویس‌ها

---

## 🗄️ بازطراحی ساختار دیتابیس

### اولویت: **بالا** - پایه و اساس تمام ویژگی‌های جدید

#### ✅ **Migration جدید: 20250731000000_enhance_database_structure - پیاده‌سازی شده**

##### **1. بهبود جدول users - پیاده‌سازی شده**
- [x] **فیلدهای امنیتی جدید:**
  - `lastLoginAt`: زمان آخرین ورود موفق
  - `loginAttempts`: تعداد تلاش‌های ورود ناموفق
  - `isBlocked`: وضعیت مسدودیت حساب
  - `blockedUntil`: زمان پایان مسدودیت
  - `failedLoginAttempts`: تعداد تلاش‌های ناموفق متوالی
  - `lastFailedLoginAt`: زمان آخرین تلاش ناموفق

##### **2. بهبود جدول wallets - پیاده‌سازی شده**
- [x] **فیلدهای مدیریتی جدید:**
  - `isActive`: وضعیت فعال بودن کیف پول
  - `currency`: نوع ارز (پیش‌فرض: IRR)
  - `walletAddress`: کد 16 رقمی منحصر به فرد کیف پول
  - `dailyTransferLimit`: محدودیت انتقال روزانه
  - `monthlyTransferLimit`: محدودیت انتقال ماهانه
  - `isVerified`: وضعیت تایید کیف پول

##### **3. بهبود جدول transactions - پیاده‌سازی شده**
- [x] **فیلدهای ردیابی جدید:**
  - `referenceId`: شماره مرجع تراکنش (16 رقمی)
  - `metadata`: اطلاعات اضافی (JSON)
  - `ipAddress`: آدرس IP کاربر
  - `userAgent`: مرورگر و سیستم عامل کاربر
  - `location`: موقعیت جغرافیایی (اختیاری)
  - `riskScore`: امتیاز ریسک تراکنش

##### **4. بهبود جدول orders - پیاده‌سازی شده**
- [x] **فیلدهای مدیریتی جدید:**
  - `commissionRate`: نرخ کارمزد اعمال شده
  - `isAutomatic`: نوع معامله (خودکار/دستی)
  - `notes`: یادداشت‌های کاربر
  - `adminNotes`: یادداشت‌های ادمین
  - `processingTime`: زمان پردازش سفارش
  - `statusHistory`: تاریخچه تغییرات وضعیت (JSON)

##### **5. بهبود جدول prices - پیاده‌سازی شده**
- [x] **فیلدهای قیمت‌گذاری جدید:**
  - `source`: منبع قیمت (API، دستی، محاسباتی)
  - `lastUpdatedBy`: آخرین کاربر به‌روزرسانی کننده
  - `priceChange`: تغییر قیمت نسبت به روز قبل
  - `priceChangePercentage`: درصد تغییر قیمت
  - `isActive`: وضعیت فعال بودن قیمت
  - `validFrom`: تاریخ شروع اعتبار
  - `validTo`: تاریخ پایان اعتبار

##### **6. بهبود جدول commissions - نیاز به پیاده‌سازی**
- [ ] **فیلدهای مدیریتی جدید:**
  - `isActive`: وضعیت فعال بودن نرخ
  - `validFrom`: تاریخ شروع اعتبار
  - `validTo`: تاریخ پایان اعتبار
  - `changedBy`: کاربر تغییر دهنده
  - `changeReason`: دلیل تغییر نرخ
  - `previousRate`: نرخ قبلی
  - `changePercentage`: درصد تغییر

##### **7. بهبود جدول transfers - پیاده‌سازی شده**
- [x] **فیلدهای امنیتی جدید:**
  - `referenceId`: شماره مرجع انتقال
  - `statusHistory`: تاریخچه تغییرات وضعیت
  - `adminNotes`: یادداشت‌های ادمین
  - `riskScore`: امتیاز ریسک انتقال
  - `isVerified`: وضعیت تایید انتقال
  - `verificationMethod`: روش تایید (SMS، ایمیل، دستی)

##### **8. بهبود جدول deliveryRequests - پیاده‌سازی شده**
- [x] **فیلدهای مدیریتی جدید:**
  - `referenceId`: شماره مرجع درخواست
  - `deliveryAddress`: آدرس تحویل
  - `contactPerson`: شخص تماس گیرنده
  - `contactPhone`: شماره تماس تحویل
  - `preferredDeliveryDate`: تاریخ ترجیحی تحویل
  - `deliveryNotes`: یادداشت‌های تحویل
  - `statusHistory`: تاریخچه تغییرات وضعیت
  - `adminNotes`: یادداشت‌های ادمین

##### **9. بهبود جدول notifications - پیاده‌سازی شده**
- [x] **فیلدهای ارسال جدید:**
  - `deliveryStatus`: وضعیت ارسال (pending، sent، failed)
  - `deliveryAttempts`: تعداد تلاش‌های ارسال
  - `lastDeliveryAttempt`: آخرین تلاش ارسال
  - `deliveryMethod`: روش ارسال (SMS، ایمیل، push)
  - `templateId`: شناسه قالب پیام
  - `metadata`: اطلاعات اضافی (JSON)
  - `isRead`: وضعیت خوانده شدن

##### **10. بهبود جدول adminUsers - پیاده‌سازی شده**
- [x] **فیلدهای امنیتی جدید:**
  - `lastLoginAt`: زمان آخرین ورود
  - `loginAttempts`: تعداد تلاش‌های ورود
  - `isActive`: وضعیت فعال بودن
  - `permissions`: مجوزهای دسترسی (JSON)
  - `role`: نقش کاربر (super_admin، admin، moderator)
  - `department`: بخش کاری
  - `phoneNumber`: شماره تماس

##### **11. بهبود جدول auditLogs - پیاده‌سازی شده**
- [x] **فیلدهای ردیابی جدید:**
  - `ipAddress`: آدرس IP کاربر
  - `userAgent`: مرورگر و سیستم عامل
  - `location`: موقعیت جغرافیایی
  - `sessionId`: شناسه نشست
  - `requestId`: شناسه درخواست
  - `responseTime`: زمان پاسخ‌دهی
  - `statusCode`: کد وضعیت HTTP
  - `errorMessage`: پیام خطا (در صورت وجود)

#### 🔧 **تغییرات Prisma Schema - پیاده‌سازی شده**

##### **1. Enum های جدید - پیاده‌سازی شده**
- [x] **UserStatus:** ACTIVE, INACTIVE, BLOCKED, PENDING_VERIFICATION
- [x] **WalletStatus:** ACTIVE, INACTIVE, SUSPENDED, PENDING_VERIFICATION
- [x] **TransactionStatus:** PENDING, COMPLETED, FAILED, CANCELLED, REFUNDED
- [x] **OrderStatus:** PENDING, PROCESSING, COMPLETED, CANCELLED, FAILED
- [x] **TransferStatus:** PENDING, PROCESSING, COMPLETED, FAILED, CANCELLED, REVERSED
- [x] **DeliveryStatus:** REQUESTED, APPROVED, PROCESSING, READY, DELIVERED, CANCELLED
- [x] **NotificationType:** SMS, EMAIL, PUSH, IN_APP
- [x] **CommissionType:** BUY, SELL, TRANSFER, DELIVERY

##### **2. فیلدهای جدید در مدل‌ها - پیاده‌سازی شده**
- [x] **User:** تمام فیلدهای جدید اضافه شده
- [x] **Wallet:** تمام فیلدهای جدید اضافه شده
- [x] **Transaction:** تمام فیلدهای جدید اضافه شده
- [x] **Order:** تمام فیلدهای جدید اضافه شده
- [x] **Price:** تمام فیلدهای جدید اضافه شده
- [x] **Transfer:** تمام فیلدهای جدید اضافه شده
- [x] **DeliveryRequest:** تمام فیلدهای جدید اضافه شده
- [x] **Notification:** تمام فیلدهای جدید اضافه شده
- [x] **AdminUser:** تمام فیلدهای جدید اضافه شده
- [x] **AuditLog:** تمام فیلدهای جدید اضافه شده

#### 📊 **Migration SQL کامل - پیاده‌سازی شده**

##### **1. ایجاد جداول جدید - پیاده‌سازی شده**
- [x] **status_history:** جدول تاریخچه تغییرات
- [x] **message_templates:** جدول قالب‌های پیام
- [x] **system_settings:** جدول تنظیمات سیستم

##### **2. اضافه کردن فیلدهای جدید - پیاده‌سازی شده**
- [x] **users:** تمام فیلدهای جدید اضافه شده
- [x] **wallets:** تمام فیلدهای جدید اضافه شده
- [x] **transactions:** تمام فیلدهای جدید اضافه شده
- [x] **orders:** تمام فیلدهای جدید اضافه شده
- [x] **prices:** تمام فیلدهای جدید اضافه شده
- [x] **transfers:** تمام فیلدهای جدید اضافه شده
- [x] **deliveryRequests:** تمام فیلدهای جدید اضافه شده
- [x] **notifications:** تمام فیلدهای جدید اضافه شده
- [x] **adminUsers:** تمام فیلدهای جدید اضافه شده
- [x] **auditLogs:** تمام فیلدهای جدید اضافه شده

#### 🔍 **Index های جدید برای عملکرد بهتر - پیاده‌سازی شده**
- [x] **users:** تمام index های مورد نیاز
- [x] **wallets:** تمام index های مورد نیاز
- [x] **transactions:** تمام index های مورد نیاز
- [x] **orders:** تمام index های مورد نیاز
- [x] **transfers:** تمام index های مورد نیاز
- [x] **deliveryRequests:** تمام index های مورد نیاز
- [x] **notifications:** تمام index های مورد نیاز
- [x] **auditLogs:** تمام index های مورد نیاز

#### 📝 **دستورات اجرای Migration - پیاده‌سازی شده**

##### **1. ایجاد Migration - پیاده‌سازی شده**
- [x] **Migration ایجاد شده:** enhance_database_structure
- [x] **Migration اجرا شده:** در محیط development
- [x] **Prisma Client به‌روزرسانی شده:** نسخه 6.12.0

##### **2. بررسی Migration - پیاده‌سازی شده**
- [x] **وضعیت migrations:** بررسی شده
- [x] **Migration های موجود:** مشاهده شده
- [x] **Migration جدید:** اجرا شده

##### **3. اجرای Migration - پیاده‌سازی شده**
- [x] **Migration در محیط development:** اجرا شده
- [x] **Migration در محیط production:** آماده اجرا
- [x] **Prisma Client جدید:** تولید شده

##### **4. به‌روزرسانی Prisma Client - پیاده‌سازی شده**
- [x] **تولید Prisma Client جدید:** انجام شده
- [x] **نسخه Prisma:** 6.12.0
- [x] **سازگاری:** با تمام فیلدهای جدید

#### ⚠️ **نکات مهم Migration - نیاز به توجه**

##### **1. Backup دیتابیس**
- [ ] **قبل از Migration:** ایجاد backup کامل از دیتابیس
- [ ] **تست Migration:** اجرای Migration در محیط test
- [ ] **Rollback Plan:** برنامه بازگشت در صورت مشکل

##### **2. Downtime**
- [ ] **زمان Migration:** برنامه‌ریزی برای کمترین downtime
- [ ] **اعلان کاربران:** اطلاع‌رسانی از زمان تعمیر و نگهداری
- [ ] **Maintenance Mode:** فعال‌سازی حالت تعمیر

##### **3. Data Migration**
- [x] **فیلدهای موجود:** حفظ داده‌های موجود
- [x] **مقادیر پیش‌فرض:** تنظیم مقادیر مناسب برای فیلدهای جدید
- [ ] **اعتبارسنجی:** بررسی صحت داده‌ها پس از Migration

#### 🎯 **نتیجه Migration - پیاده‌سازی شده**

پس از اجرای موفق Migration جدید:

- ✅ **ساختار دیتابیس بهبود یافته** و آماده برای ویژگی‌های جدید
- ✅ **امنیت سیستم افزایش یافته** با فیلدهای امنیتی جدید
- ✅ **عملکرد بهتر** با Index های بهینه
- ✅ **قابلیت ردیابی کامل** تمام عملیات سیستم
- ✅ **انعطاف‌پذیری بیشتر** برای توسعه‌های آینده

---

## 📱 سیستم اعلان‌های SMS

### اولویت: **بالا** - برای جلوگیری از دبه و تضمین شفافیت معاملات

#### ⚠️ **اعلان‌های معاملات خرید و فروش - نیاز به پیاده‌سازی**
- [ ] **خرید طلا:** "معامله خرید انجام شد - میزان: X گرم، قیمت هر گرم: X تومان، مبلغ کل: X تومان، تاریخ: X"
- [ ] **فروش طلا:** "معامله فروش انجام شد - میزان: X گرم، قیمت هر گرم: X تومان، مبلغ کل: X تومان، تاریخ: X"
- [ ] **جزئیات کامل:** شامل نوع محصول (18K، سکه بهار، نیم سکه، ربع سکه)

#### ⚠️ **اعلان‌های مالی - نیاز به پیاده‌سازی**
- [ ] **واریز پول:** "مبلغ X تومان به حساب شما واریز شد، موجودی جدید: X تومان"
- [ ] **برداشت پول:** "مبلغ X تومان از حساب شما برداشت شد، موجودی جدید: X تومان"
- [ ] **خرید طلا:** "X گرم طلا به کیف پول طلای شما اضافه شد، موجودی طلا: X گرم"
- [ ] **فروش طلا:** "X گرم طلا از کیف پول طلای شما کم شد، موجودی طلا: X گرم"

#### ⚠️ **اعلان‌های تحویل طلای فیزیکی - نیاز به پیاده‌سازی**
- [ ] **درخواست تحویل:** "درخواست تحویل X گرم طلای فیزیکی ثبت شد، کارمزد: X تومان"
- [ ] **تایید تحویل:** "درخواست تحویل شما تایید شد، ظرف 10 روز آماده تحویل خواهد بود"
- [ ] **آماده تحویل:** "طلای فیزیکی شما آماده تحویل است، لطفاً به فروشگاه مراجعه کنید"

---

## 🏠 صفحه اصلی (Landing Page)

### اولویت: **بالا** - برای معرفی و اعتمادسازی

#### ⚠️ **محتوای اصلی - نیاز به پیاده‌سازی**
- [ ] **معرفی شرکت:** توضیحات کامل درباره کیمیاگر
- [ ] **خدمات اصلی:** خرید و فروش طلای آب شده، نگهداری در خزانه امن
- [ ] **مزایا:** امنیت، شفافیت، قیمت‌های منصفانه
- [ ] **دسترسی‌ها:** دکمه‌های "ورود به حساب" و "ثبت‌نام"

#### ⚠️ **طراحی و UX - نیاز به پیاده‌سازی**
- [ ] **طراحی حرفه‌ای:** مشابه دیجی‌گلد و سایر پلتفرم‌های معتبر
- [ ] **راست‌چین:** مناسب زبان فارسی
- [ ] **واکنش‌گرا:** سازگار با موبایل و دسکتاپ
- [ ] **اعتمادسازی:** گواهینامه‌ها، نظرات مشتریان، آمار

---

## 📱 بهینه‌سازی داشبورد موبایل

### اولویت: **متوسط** - بهبود تجربه کاربری

#### ⚠️ **تغییرات چیدمان - نیاز به پیاده‌سازی**
- [ ] **موبایل:** نمودار زیر خلاصه کیف پول، دسترسی‌های سریع بالاتر
- [ ] **دسکتاپ:** خلاصه کیف پول سمت راست، دسترسی‌ها گوشه
- [ ] **سازگاری:** تشخیص خودکار نوع دستگاه و تغییر چیدمان

---

## 🛒 صفحات جداگانه خرید و فروش

### اولویت: **بالا** - جداسازی کامل فرآیندها

#### ⚠️ **صفحه خرید (Buy Page) - نیاز به پیاده‌سازی**
- [ ] **فقط قیمت‌های خرید:** نمایش قیمت خرید برای تمام محصولات
- [ ] **محصولات:** طلای 18K، سکه بهار آزادی، نیم سکه، ربع سکه
- [ ] **حذف عناصر:** نوع معامله دستی، تاییدیه اپراتور
- [ ] **ورودی‌های دوگانه:** وزن (گرم) + معادل ریالی
- [ ] **نمایش موجودی:** موجودی ریالی کیف پول کاربر

#### ⚠️ **صفحه فروش (Sell Page) - نیاز به پیاده‌سازی**
- [ ] **فقط قیمت‌های فروش:** نمایش قیمت فروش برای تمام محصولات
- [ ] **محصولات:** طلای 18K، سکه بهار آزادی، نیم سکه، ربع سکه
- [ ] **حذف عناصر:** نوع معامله دستی، تاییدیه اپراتور
- [ ] **ورودی‌های دوگانه:** وزن (گرم) + معادل ریالی
- [ ] **نمایش موجودی:** موجودی طلای کیف پول کاربر

---

## 💰 ورودی‌های انعطاف‌پذیر معاملات

### اولویت: **بالا** - انعطاف‌پذیری کاربر

#### ⚠️ **ورودی دوگانه - نیاز به پیاده‌سازی**
- [ ] **وزن (گرم):** کاربر می‌تواند مستقیماً وزن طلا را وارد کند
- [ ] **معادل ریالی:** کاربر می‌تواند مبلغ ریالی را وارد کند
- [ ] **تبدیل خودکار:** محاسبه خودکار معادل وزن/ریال
- [ ] **اعتبارسنجی:** بررسی موجودی کافی

#### ⚠️ **اعتبارسنجی سکه‌ها - نیاز به پیاده‌سازی**
- [ ] **تعداد کامل:** سکه‌ها فقط به صورت عدد کامل قابل ورود
- [ ] **پیام خطا:** "سکه باید به صورت تعداد کامل وارد شود"
- [ ] **محاسبه دقیق:** تبدیل وزن به تعداد سکه

---

## 🎨 بهبود رنگ‌بندی و طراحی

### اولویت: **متوسط** - ظاهر حرفه‌ای‌تر

#### ⚠️ **تغییرات رنگ - نیاز به پیاده‌سازی**
- [ ] **رنگ‌های جدید:** خروج از حالت خامی، رنگ‌های پخته و جذاب
- [ ] **تم طلایی:** حفظ هویت طلایی اما بهبود شده
- [ ] **کنتراست:** بهبود خوانایی و زیبایی
- [ ] **سازگاری:** رنگ‌های مناسب برای تمام المنت‌ها

---

## 🔄 انتقال بین کاربران

### اولویت: **متوسط** - قابلیت جدید

#### ✅ **آدرس کیف پول - پیاده‌سازی شده**
- [x] **کد 16 رقمی:** هر کاربر یک کد منحصر به فرد دریافت می‌کند
- [x] **شبیه شماره کارت:** فرمت آسان برای به خاطر سپردن
- [x] **تولید خودکار:** در زمان ثبت‌نام

#### ⚠️ **فرآیند انتقال - نیاز به پیاده‌سازی**
- [ ] **انتخاب مبدا:** کیف پول کاربر فرستنده
- [ ] **انتخاب مقصد:** وارد کردن کد 16 رقمی کاربر گیرنده
- [ ] **انتخاب نوع:** انتقال پول یا طلا
- [ ] **مبلغ/وزن:** تعیین مقدار انتقال
- [ ] **کمک‌مزد:** کسر کارمزد از انتقال

---

## 📦 تحویل طلای فیزیکی

### اولویت: **متوسط** - قابلیت جدید

#### ⚠️ **قوانین تحویل - نیاز به پیاده‌سازی**
- [ ] **مبنای 5 گرم:** تحویل فقط به صورت مضرب 5 گرم
- [ ] **مثال:** 48 گرم موجودی = امکان تحویل 45 گرم
- [ ] **کارمزد:** کسر کارمزد از درخواست

#### ⚠️ **فرآیند تحویل - نیاز به پیاده‌سازی**
- [ ] **درخواست:** کاربر درخواست تحویل می‌دهد
- [ ] **تایید پشتیبانی:** بررسی توسط تیم پشتیبانی
- [ ] **زمان تحویل:** حداکثر 10 روز کاری
- [ ] **محل تحویل:** فروشگاه‌های مشخص شده

---

## 🆘 پشتیبانی و اطلاعات

### اولویت: **پایین** - تکمیل اطلاعات

#### ⚠️ **بخش پشتیبانی - نیاز به پیاده‌سازی**
- [ ] **سوالات متداول:** پاسخ به سوالات رایج
- [ ] **تماس با پشتیبانی:** اطلاعات تماس
- [ ] **راهنمای استفاده:** آموزش استفاده از پلتفرم

#### ⚠️ **درباره ما - نیاز به پیاده‌سازی**
- [ ] **تاریخچه شرکت:** معرفی کامل
- [ ] **ماموریت و چشم‌انداز:** اهداف شرکت
- [ ] **تیم:** معرفی اعضای کلیدی
- [ ] **مدارک و مجوزها:** گواهینامه‌های رسمی

---

## 🪙 گسترش انواع سکه

### اولویت: **متوسط** - تکمیل محصولات

#### ✅ **سکه‌های جدید - پیاده‌سازی شده در دیتابیس**
- [x] **تمام سکه 86:** اضافه کردن به ProductType
- [x] **نیم سکه 86:** اضافه کردن به ProductType
- [x] **ربع سکه 86:** اضافه کردن به ProductType
- [x] **قیمت‌گذاری:** تعیین قیمت خرید و فروش

#### ✅ **به‌روزرسانی دیتابیس - تکمیل شده**
- [x] **Prisma Schema:** اضافه کردن enum های جدید
- [x] **Migration:** اجرای migration برای جداول
- [x] **API Routes:** به‌روزرسانی API های قیمت و کارمزد
- [x] **UI:** نمایش سکه‌های 86 در رابط کاربری

---

## 💱 منبع قیمت طلا

### اولویت: **متوسط** - قیمت‌گذاری دقیق

#### ⚠️ **قیمت نقد خرد - نیاز به پیاده‌سازی**
- [ ] **تایید منبع:** استفاده از قیمت نقد خرد برای طلای 18K
- [ ] **به‌روزرسانی:** اتصال به API قیمت‌های لحظه‌ای
- [ ] **اعتبارسنجی:** بررسی صحت قیمت‌ها

---

## 🔄 تغییرات اصطلاحات

### اولویت: **پایین** - یکسان‌سازی زبان

#### ⚠️ **تغییرات UI - نیاز به پیاده‌سازی**
- [ ] **کمیسیون → کارمزد:** در تمام بخش‌های رابط کاربری
- [ ] **یوزرنیم → نام کاربری:** در فرم‌های ورود و ثبت‌نام
- [ ] **پسورد → رمز عبور:** در تمام بخش‌ها
- [ ] **فایل‌های ترجمه:** ایجاد فایل‌های زبان فارسی

---

## ⚙️ کارمزد قابل تنظیم

### اولویت: **بالا** - کنترل مدیریتی

#### ⚠️ **پنل مدیریت - نیاز به پیاده‌سازی**
- [ ] **تنظیم کارمزد:** امکان تغییر سریع نرخ‌های کارمزد
- [ ] **انعطاف‌پذیری:** تغییر از 0.5% تا 1% بر اساس شرایط بازار
- [ ] **نمایش کاربر:** نمایش کارمزد فعلی به کاربران
- [ ] **تاریخچه:** ثبت تغییرات کارمزد

#### ⚠️ **API مدیریت - نیاز به پیاده‌سازی**
- [ ] **PUT /api/admin/commission:** تغییر نرخ کارمزد
- [ ] **GET /api/admin/commission:** دریافت نرخ‌های فعلی
- [ ] **POST /api/admin/commission/history:** تاریخچه تغییرات

---

## 🚨 مدیریت موجودی ناکافی

### اولویت: **بالا** - تجربه کاربری بهتر

#### ⚠️ **پیام‌های خطا - نیاز به پیاده‌سازی**
- [ ] **موجودی کم:** "موجودی کیف پول ناکافی است"
- [ ] **مبلغ مورد نیاز:** "نیاز به X تومان بیشتر"
- [ ] **اتصال درگاه:** "برای تکمیل خرید، به درگاه پرداخت متصل شوید"

#### ⚠️ **فرآیند پرداخت - نیاز به پیاده‌سازی**
- [ ] **محاسبه کسری:** محاسبه مبلغ مورد نیاز
- [ ] **درگاه پرداخت:** اتصال به درگاه برای پرداخت کسری
- [ ] **تکمیل معامله:** تکمیل معامله پس از پرداخت

---

## 🔧 مشکلات فنی موجود

### اولویت: **متوسط** - رفع مشکلات

#### ⚠️ **فایل‌های TypeScript - نیاز به بررسی**
- [x] **تایید .tsx:** تایید اینکه .tsx قابل قبول است
- [x] **یکسان‌سازی:** استفاده از TypeScript در تمام فایل‌ها

#### ✅ **فونت‌ها - حل شد**
- [x] **یکسان‌سازی:** استفاده از Vazirmatn در تمام فایل‌ها
- [x] **حذف Tahoma:** از app/layout.tsx - **مشکل حل شد**

#### ⚠️ **متغیرهای محیطی - نیاز به تکمیل**
- [ ] **ایجاد .env.example:** فایل نمونه برای تنظیمات
- [ ] **مستندسازی:** توضیح کامل متغیرها

#### ✅ **مشکلات فوری - حل شد**
- [x] **خطای OTP:** مشکل در فیلد `lastFailedLoginAt` در send-otp حل شد
- [x] **فایل commissions:** ایجاد API route برای مدیریت کارمزدها تکمیل شد
- [x] **سکه‌های 86:** نمایش در UI پیاده‌سازی شد

---

## 📊 اولویت‌بندی اجرا

### فاز 1 (اولویت بالا - هفته 1-2) - **تکمیل شده**
1. ✅ **سیستم احراز هویت پیشرفته (SMS + ایمیل)** - پیاده‌سازی شده
2. ✅ **سیستم OTP و لاگین** - کامپوننت‌های OTPForm و بهبود LoginForm
3. ✅ **API کارمزد قابل تنظیم** - ایجاد و پیاده‌سازی کامل
4. ✅ **سکه‌های 86** - اضافه شدن به UI و API ها
5. ✅ **رفع مشکلات فنی** - فونت، OTP، commissions
6. ⚠️ **صفحات جداگانه خرید و فروش** - نیاز به پیاده‌سازی
7. ⚠️ **ورودی‌های انعطاف‌پذیر معاملات** - نیاز به پیاده‌سازی
8. ⚠️ **مدیریت موجودی ناکافی** - نیاز به پیاده‌سازی

### فاز 2 (اولویت متوسط - هفته 3-4)
1. ⚠️ **صفحه اصلی (Landing Page)** - نیاز به پیاده‌سازی
2. ⚠️ **بهینه‌سازی داشبورد موبایل** - نیاز به پیاده‌سازی
3. ⚠️ **انتقال بین کاربران** - نیاز به تکمیل UI
4. ⚠️ **تحویل طلای فیزیکی** - نیاز به پیاده‌سازی
5. ⚠️ **گسترش انواع سکه** - نیاز به تکمیل UI

### فاز 3 (اولویت پایین - هفته 5-6)
1. ⚠️ **بهبود رنگ‌بندی و طراحی** - نیاز به پیاده‌سازی
2. ⚠️ **بخش پشتیبانی و اطلاعات** - نیاز به پیاده‌سازی
3. ⚠️ **تغییرات اصطلاحات** - نیاز به پیاده‌سازی
4. ⚠️ **رفع مشکلات فنی** - نیاز به رفع

---

## 🎯 نتیجه نهایی مورد انتظار

پس از تکمیل تمام این ویژگی‌ها، پلتفرم کیمیاگر تبدیل خواهد شد به:

- **پلتفرم کامل و حرفه‌ای** خرید و فروش طلا
- **سیستم احراز هویت امن** با لاگین SMS و ثبت‌نام ایمیل
- **سیستم شفاف** با اعلان‌های SMS برای جلوگیری از دبه
- **رابط کاربری بهینه** برای موبایل و دسکتاپ
- **قابلیت‌های پیشرفته** مانند انتقال بین کاربران و تحویل فیزیکی
- **مدیریت انعطاف‌پذیر** کارمزدها بر اساس شرایط بازار
- **تجربه کاربری برتر** با طراحی زیبا و کاربردی

---

## 📈 **پیشرفت کلی پروژه**

### **وضعیت فعلی: 65% تکمیل شده**

- ✅ **ساختار دیتابیس:** 100% تکمیل شده
- ✅ **سیستم احراز هویت:** 95% تکمیل شده
- ✅ **API Routes اصلی:** 90% تکمیل شده
- ✅ **کامپوننت‌های React:** 85% تکمیل شده
- ✅ **سیستم OTP و لاگین:** 100% تکمیل شده
- ✅ **API کارمزد:** 100% تکمیل شده
- ✅ **سکه‌های 86:** 100% تکمیل شده
- ⚠️ **سیستم اعلان‌ها:** 30% تکمیل شده
- ⚠️ **رابط کاربری:** 75% تکمیل شده
- ⚠️ **سیستم مدیریت:** 50% تکمیل شده

---

**تاریخ ایجاد:** 22 تیر 1403  
**آخرین به‌روزرسانی:** 31 تیر 1403 - **سیستم OTP و لاگین بهبود یافت**  
**وضعیت:** چک‌لیست به‌روزرسانی شده، مشکلات فوری حل شد، آماده برای ادامه توسعه  
**نکته مهم:** این فایل فقط چک‌لیست است و هیچ تغییری در کد ایجاد نمی‌کند
